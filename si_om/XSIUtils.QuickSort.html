<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
<link href="../style/prettify.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../scripts/prettify.js"></script><script src="../scripts/lib/jquery-1.9.1.min.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script>
      <title>XSIUtils.QuickSort</title>
   
</head>
   <body height="100%"><div class="body_content" id="body-content"><style>
/*  These settings override ones in the default stylesheets
	used by the merged files that cause problems in combination
	with the standard HTML help styles and page templates. */

div, div.example, div.tip {
	 margin:0;
}

td.example {
	background: inherit;
}

/* This fixes a problem with nested pre blocks on an example page */
pre pre {
	display:block;
	padding:0;
	border-style:none;
}
</style><link rel="stylesheet" href="si_om/css/en.css" type="text/css" /><script>$(document).ready(function() { yepnope.injectJs("./si_om/lib/utils.js"); });</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">var reflinkid = "si_cpp"; var reflinkdata = new Array(); function closeRefLinkDiv() { }; $(document).on('click', function() { closeRefLinkDiv(); } );</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/multireflink.js"); });</script><script>$(document).ready(function () { prettyPrint(); } );</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type='text/javascript'>$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script type="text/javascript">
 </script><!-- begin MT -->
            
            <div id='MicrosoftTranslatorWidget' class='Dark' style='position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden'></div><div id="reflinkdiv" style="display:none; font-family: 'RobotoRegular', Arial, Tahoma, sans-serif; visibility:hidden; position:absolute; z-index:40001; padding:5px; border-style:solid; border-width:1px; border-color:#666666; background-color:#dfdfdf; overflow:visible"></div>
      <div>
         <div class="head">
            <h1>XSIUtils.QuickSort</h1>
         </div>

<h2 class="pagehead"><a href="#!/url=./si_om/XSIUtils.html">XSIUtils</a>.QuickSort</h2>

<h3>Description</h3>
<div><p> Performs an in-place QuickSort of an array (which can be multi-dimensional). The sort 
is performed on the first element of each dimension. If the first elements are equal, then 
the second elements are compared, and so on.<br /><br />
There are several types of sorting algorithms, such as BubbleSort, QuickSort,
Insertion, Shaker, and Selection. The QuickSort algorithm is very good at sorting 
large amounts of data efficiently. It basically uses a divide-and-conquer approach. <br /><br />
Note: This method invokes the built-in JScript sort method when the Array argument 
is a Jscript array.   The
JScript sort method uses a case-sensitive text-based 
ordering, which is not likely to be the intended result when sorting numeric data. 
A workaround is demonstrated in the examples below.
</p></div>

<h3>C# Syntax</h3>
<div><p><table>
	<tr>
		<td class="example"><pre>XSIUtils.QuickSort( Object& io_Array );</pre>		</td>	</tr>
</table>
</p></div>

<h3>Scripting Syntax</h3>
<div><p><table>
	<tr>
		<td class="example"><pre>XSIUtils.QuickSort( Array );</pre>		</td>	</tr>
</table>
</p></div>

<h3>Parameters</h3>
<div><p><table cellpadding="5" cellspacing="5">
	<tr>
		<th title="Name of the parameter">Parameter		</th>
		<th title="Data type">Type		</th>
		<th title="Description of the parameter">Description		</th>
	</tr>
	<tr>
		<td class="name">Array		</td>
		<td><a href="#!/url=./files/Array.htm">Array</a>		</td>
		<td>
 The array to sort. 		</td>
	</tr>
</table>
</p></div>

<h3>Examples</h3>
<div><p><h4>1. VBScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="vbscript">'
' This example demonstrates how to sort an array with the QuickSort method. 
'
Dim aValues
aValues = array(8,1,9,4,6)
XSIUtils.QuickSort aValues
for each item in aValues
	Application.LogMessage item 
next
' Expected result:
'INFO : "1"
'INFO : "4"
'INFO : "6"
'INFO : "8"
'INFO : "9"</pre></td></tr>
</table>
</div><h4>2. Python Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="python">#
# This example demonstrates how to sort an array with the QuickSort method. 
#
aValues = [8,1,9,4,6]
aValues = XSIUtils.QuickSort(aValues)
for item in aValues:
	Application.LogMessage( '%(item)d'%vars() )
# Expected result:
#INFO : "1"
#INFO : "4"
#INFO : "6"
#INFO : "8"
#INFO : "9"</pre></td></tr>
</table>
</div><h4>3. VBScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="vbscript">'VBScript example : sort of a 2 dimension array
Dim TestArray()
ReDim TestArray(4, 4)
TestArray(0, 0) = -1.9
TestArray(1, 0) = 8
TestArray(2,0) = 4
TestArray(3,0) = 543
TestArray(4,0) = 0
TestArray(0, 1) = 3.2
TestArray(1, 1) = 5
TestArray(2,1) = -100
TestArray(3,1) = 99
TestArray(4,1) = 2
TestArray(0, 2) = 10.3
TestArray(1, 2) = 7
TestArray(2,2) = 6
TestArray(3,2) = 5
TestArray(4,2) = 4
TestArray(0, 3) = 3.2
TestArray(1, 3) = 9
TestArray(2,3) = 2
TestArray(3,3) = 3
TestArray(4,3) = 4
TestArray(0, 4) = -5.4
TestArray(1, 4) = 2
TestArray(2,4) = 1000
TestArray(3,4) = 500
TestArray(4,4) = 2000
Application.LogMessage "Array before sort : "
Application.LogMessage TestArray(0, 0) &amp; " " &amp; TestArray(1, 0) &amp; " " &amp; TestArray(2, 0) &amp; " " &amp; TestArray(3, 0) &amp; " " &amp; TestArray(4, 0)
Application.LogMessage TestArray(0, 1) &amp; " " &amp; TestArray(1, 1) &amp; " " &amp; TestArray(2, 1) &amp; " " &amp; TestArray(3, 1) &amp; " " &amp; TestArray(4, 1)
Application.LogMessage TestArray(0, 2) &amp; " " &amp; TestArray(1, 2) &amp; " " &amp; TestArray(2, 2) &amp; " " &amp; TestArray(3, 2) &amp; " " &amp; TestArray(4, 2)
Application.LogMessage TestArray(0, 3) &amp; " " &amp; TestArray(1, 3) &amp; " " &amp; TestArray(2, 3) &amp; " " &amp; TestArray(3, 3) &amp; " " &amp; TestArray(4, 3)
Application.LogMessage TestArray(0, 4) &amp; " " &amp; TestArray(1, 4) &amp; " " &amp; TestArray(2, 4) &amp; " " &amp; TestArray(3, 4) &amp; " " &amp; TestArray(4, 4)
XSIUtils.QuickSort TestArray
Application.LogMessage "Array after sort : "
Application.LogMessage TestArray(0, 0) &amp; " " &amp; TestArray(1, 0) &amp; " " &amp; TestArray(2, 0) &amp; " " &amp; TestArray(3, 0) &amp; " " &amp; TestArray(4, 0)
Application.LogMessage TestArray(0, 1) &amp; " " &amp; TestArray(1, 1) &amp; " " &amp; TestArray(2, 1) &amp; " " &amp; TestArray(3, 1) &amp; " " &amp; TestArray(4, 1)
Application.LogMessage TestArray(0, 2) &amp; " " &amp; TestArray(1, 2) &amp; " " &amp; TestArray(2, 2) &amp; " " &amp; TestArray(3, 2) &amp; " " &amp; TestArray(4, 2)
Application.LogMessage TestArray(0, 3) &amp; " " &amp; TestArray(1, 3) &amp; " " &amp; TestArray(2, 3) &amp; " " &amp; TestArray(3, 3) &amp; " " &amp; TestArray(4, 3)
Application.LogMessage TestArray(0, 4) &amp; " " &amp; TestArray(1, 4) &amp; " " &amp; TestArray(2, 4) &amp; " " &amp; TestArray(3, 4) &amp; " " &amp; TestArray(4, 4)</pre></td></tr>
</table>
</div><h4>4. JScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="jscript">// This example demonstrates using XSIUtils.Sort
// with a JScript error.
a = new Array( "C", "a", "Check", "Z", "zed" ) ;
logmessage("before: a=[" + a + "]");
// This is identical to calling a.sort(); 
XSIUtils.QuickSort(a);
logmessage("after: a=[" + a + "]");
//Expected output (notice that the sort has
//been performed in a case-sensitive fashion)
//INFO : after: a=[C,Check,Z,a,zed]</pre></td></tr>
</table>
</div><h4>5. JScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="jscript">// This example shows how better sort results
// can be achieved by using the built-in JScript 
// array sorting algorithm.
//
//----------------------
// MySortFunction is a function provided to the
// sort method to implement the comparison function.
//
// As documented in the JScript documentation this 
// method must return:
// -A negative value if the first argument passed is less than the second argument. 
// -Zero if the two arguments are equivalent. 
// -A positive value if the first argument is greater than the second argument
//
// In this basic example the sort function can sort strings
// or numbers but does not expect a mix of both types and
// does not sort other types of data.
//----------------------
function MySortFunction( a, b )
{
	if ( typeof( a ) == "string" )
	{		
		aLower = a.toLowerCase() ;
		bLower = b.toLowerCase() ;
		if ( aLower &lt; bLower )
		{
			return -1 ;
		}
		else if ( bLower &lt; aLower )
		{
			return 1 ;
		}
		return 0 ;
	}
	else if ( typeof( a ) == "number" )
	{	
		return a - b ;
	}
	else
	{
		throw( new Error( 0, 
				"This function can only sort numbers and strings" ) ) ;
	}
}
// Demonstrate with strings
testArray = new Array( "C", "a", "Check", "Z", "zed" ) ;
testArray.sort( MySortFunction ) ;
logmessage("after: testArray=[" + testArray + "]");
//Expected output
//INFO : after: testArray=[a,C,Check,Z,zed]
// Demonstrate with numbers
testArray = new Array( 0.3, -1.9, 2, 1e10, 0 ) ;
testArray.sort( MySortFunction ) ;
logmessage("after: testArray=[" + testArray + "]");
//Expected output
//INFO : after: testArray=[-1.9,0,0.3,2,10000000000]</pre></td></tr>
</table>
</div></p></div>

      <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br /></div>
   </div></body>
</html>
