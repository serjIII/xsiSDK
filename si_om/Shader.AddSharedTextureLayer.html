<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
<link href="../style/prettify.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../scripts/prettify.js"></script><script src="../scripts/lib/jquery-1.9.1.min.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script>
      <title>Shader.AddSharedTextureLayer</title>
   
</head>
   <body height="100%"><div class="body_content" id="body-content"><style>
/*  These settings override ones in the default stylesheets
	used by the merged files that cause problems in combination
	with the standard HTML help styles and page templates. */

div, div.example, div.tip {
	 margin:0;
}

td.example {
	background: inherit;
}

/* This fixes a problem with nested pre blocks on an example page */
pre pre {
	display:block;
	padding:0;
	border-style:none;
}
</style><link rel="stylesheet" href="si_om/css/en.css" type="text/css" /><script>$(document).ready(function() { yepnope.injectJs("./si_om/lib/utils.js"); });</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">var reflinkid = "si_cpp"; var reflinkdata = new Array(); function closeRefLinkDiv() { }; $(document).on('click', function() { closeRefLinkDiv(); } );</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/multireflink.js"); });</script><script>$(document).ready(function () { prettyPrint(); } );</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type='text/javascript'>$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script type="text/javascript">
 </script><!-- begin MT -->
            
            <div id='MicrosoftTranslatorWidget' class='Dark' style='position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden'></div><div id="reflinkdiv" style="display:none; font-family: 'RobotoRegular', Arial, Tahoma, sans-serif; visibility:hidden; position:absolute; z-index:40001; padding:5px; border-style:solid; border-width:1px; border-color:#666666; background-color:#dfdfdf; overflow:visible"></div>
      <div>
         <div class="head">
            <h1>Shader.AddSharedTextureLayer</h1>
         </div>

<h2 class="pagehead"><a href="#!/url=./si_om/Shader.html">Shader</a>.AddSharedTextureLayer</h2>

<h3>Introduced</h3>
<div><p>v4.0</p></div>

<h3>Description</h3>
<div><p> Adds an existing texture layer to the container.  The layer already belongs
to at least one other texture layer container (either <a href="#!/url=./si_om/Shader.html">Shader</a>
or <a href="#!/url=./si_om/Material.html">Material</a>).<br /><br />
A texture layer is an object which simplifies layering texture effects on top of shaders and
materials. Each layer has a set of properties which describe its characteristics (such as color,
mixing mode, weight) to specify how it will affect the shader ports it drives. The order
that layers appear under a container indicates the order the layering is applied, similar to the
way a "mix N colors" shader node works. Texture layer port objects (see
<a href="#!/url=./si_om/TextureLayer.AddTextureLayerPort.html">TextureLayer.AddTextureLayerPort</a>) are owned by layers, and are used to specify
which shader ports the layer should affect.  <br /><br />
Tip: A <a href="#!/url=./si_om/Material.html">Material</a> can also be a texture layer container, and has the same set of 
related methods. 
</p></div>

<h3>C# Syntax</h3>
<div><p><table>
	<tr>
		<td class="example"><pre>Shader.AddSharedTextureLayer( Object in_varLayerToAdd, Boolean in_bAfter, Object in_varRefLayer );</pre>		</td>	</tr>
</table>
</p></div>

<h3>Scripting Syntax</h3>
<div><p><table>
	<tr>
		<td class="example"><pre>Shader.AddSharedTextureLayer( Layer, [After], [Reference] );</pre>		</td>	</tr>
</table>
</p></div>

<h3>Parameters</h3>
<div><p><table cellpadding="5" cellspacing="5">
	<tr>
		<th title="Name of the parameter">Parameter		</th>
		<th title="Data type">Type		</th>
		<th title="Description of the parameter">Description		</th>
	</tr>
	<tr>
		<td class="name">Layer		</td>
		<td><a href="#!/url=./si_om/TextureLayer.html">TextureLayer</a> or <a href="#!/url=./files/String.htm">String</a>		</td>
		<td>
Texture layer to add to this container. 		</td>
	</tr>
	<tr>
		<td class="name">After		</td>
		<td><a href="#!/url=./files/Boolean.htm">Boolean</a>		</td>
		<td>

		True to insert the new texture layer after the reference layer. False to insert
		it before. If no reference layer, then True will add at the end of the container's list,
		False will add it at the start. 
				<p class="cell"><span class="hilite">Default Value: </span>
True			</p>
		</td>
	</tr>
	<tr>
		<td class="name">Reference		</td>
		<td><a href="#!/url=./si_om/TextureLayer.html">TextureLayer</a> or <a href="#!/url=./files/String.htm">String</a>		</td>
		<td>

		Reference texture layer, to indicate where the newly-added layer should be
		located in the stack. The layer will be inserted adjacent to (before or after) the
		reference layer. If not specified, then the new layer will be added at the beginning or
		the end, depending on the value of the following argument. 
			</td>
	</tr>
</table>
</p></div>

<h3>Examples</h3>
<div><p><h4>1. JScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="jscript">/*
	This JScript example shows creating and sharing 
	texture layers.  It also shows how both Shaders and
	Materials can be texture layer containers, and the same
	layer can drive ports on each of them (if desired).
*/
oRoot = ActiveProject.ActiveScene.Root;
oSph = oRoot.AddGeometry( "Sphere", "MeshSurface" );
oMat = oSph.AddMaterial( "Phong" );
oPhong = oMat.Shaders(0);
// Add a layer to the Phong.
oShared = oPhong.CreateTextureLayer( "SharedLayer" );
// Add an unshared layer to the Material.
oRough = oMat.CreateTextureLayer( "Rough" );
// Add the first layer to the material, thereby sharing it.
// We'll put it before the Rough layer.
oMat.AddSharedTextureLayer( oShared, false, oRough );
// Now for fun, let's create a Fractal, attach it to the
// color input of the shared layer, and make it drive
// both the Phong's diffuse and the Material's displacement.
oParam = Application.Dictionary.GetObject( oShared + ".Color" );
oFractal = oParam.ConnectFromPreset( "Fractal", siTextureShaderFamily );
oDiffuse = oShared.AddTextureLayerPort( oPhong.Parameters( "diffuse" ) );
oDispl = oShared.AddTextureLayerPort( oMat.Parameters( "displacement" ) );
// Now let's explore what we have created...
DumpTextureLayerContainer( oMat );
function DumpTextureLayerContainer( in_cont )
{
	Application.LogMessage( "CONTAINER: " + in_cont.Name );
	for ( var i = 0; i &lt; in_cont.TextureLayers.Count; i++ )
	{
		oTextureLayer = in_cont.TextureLayers(i);
		DumpTextureLayer( oTextureLayer, i+1 );
	}
}
function DumpTextureLayer( in_layer, in_index )
{
	Application.LogMessage( "   Layer " + in_index + ": " + in_layer.Name );
	oColor = in_layer.Parameters("Color");
	var empty;
	if ( oColor == empty )
	{
		Application.LogMessage( "     Color: (" + in_layer.Red.Value +
						"," + in_layer.Green.Value +
						"," + in_layer.Blue.Value + ")" );
	}
	else
	{
		oColorSrc = in_layer.Color.Source;
		Application.LogMessage( "     Color driven by: " + oColorSrc.Name );
	}
	oPorts = in_layer.TextureLayerPorts;
	count = oPorts.Count;
	Application.LogMessage( "     Layer drives:" );
	if ( count == 0 )
		Application.LogMessage( "       &lt;nothing&gt;" );
	else
	{
		for ( i = 0; i &lt; count; i++ )
		{
			Application.LogMessage( "       " + oPorts(i).Target.FullName );
		}
	}
}
// This example should log something like:
//INFO : CONTAINER: Material
//INFO :    Layer 1: SharedLayer
//INFO :      Color driven by: Fractal
//INFO :      Layer drives:
//INFO :        Sources.Materials.DefaultLib.Material.Phong.diffuse
//INFO :        Sources.Materials.DefaultLib.Material.displacement
//INFO :    Layer 2: Rough
//INFO :      Color: (0.699999988079071,0.699999988079071,0.699999988079071)
//INFO :      Layer drives:
//INFO :        &lt;nothing&gt;</pre></td></tr>
</table>
</div><h4>2. VBScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="vbscript">'
' This VBScript example shows creating and sharing 
' texture layers.  It also shows how both Shaders and
' Materials can be texture layer containers, and the same
' layer can drive ports on each of them (if desired).
'
set oRoot = ActiveProject.ActiveScene.Root
set oSph = oRoot.AddGeometry( "Sphere", "MeshSurface" )
set oMat = oSph.AddMaterial( "Phong" )
set oPhong = oMat.Shaders(0)
' Add a layer to the Phong.
set oShared = oPhong.CreateTextureLayer( "SharedLayer" )
' Add an unshared layer to the Material.
set oRough = oMat.CreateTextureLayer( "Rough" )
' Add the first layer to the material, thereby sharing it.
' We'll put it before the Rough layer.
oMat.AddSharedTextureLayer oShared, False, oRough
' Now for fun, let's create a Fractal, attach it to the
' color input of the shared layer, and make it drive
' both the Phong's diffuse and the Material's displacement.
set oParam = Dictionary.GetObject( oShared &amp; ".Color" )
set oFractal = oParam.ConnectFromPreset( "Fractal", siTextureShaderFamily )
set oDiffuse = oShared.AddTextureLayerPort( oPhong.Parameters( "diffuse" ) )
set oDispl = oShared.AddTextureLayerPort( oMat.Parameters( "displacement" ) )
' Now let's explore what we have created...
DumpTextureLayerContainer oMat
sub DumpTextureLayerContainer( in_cont )
	LogMessage "CONTAINER: " &amp; in_cont.Name
	i = 1
	for each oTextureLayer in in_cont.TextureLayers
		DumpTextureLayer oTextureLayer, i
		i = i + 1
	next
end sub
sub DumpTextureLayer( in_layer, in_index )
	LogMessage "   Layer " &amp; in_index &amp; ": " &amp; in_layer.Name
	set oColor = in_layer.Parameters("Color")
	if TypeName( oColor ) = "Nothing" then
		LogMessage "     Color: (" &amp; in_layer.Red.Value &amp; _
						"," &amp; in_layer.Green.Value &amp; _
						"," &amp; in_layer.Blue.Value &amp; ")"
	else
		set oColorSrc = in_layer.Color.Source
		LogMessage "     Color driven by: " &amp; oColorSrc.Name
	end if
	set oPorts = in_layer.TextureLayerPorts
	count = oPorts.Count
	if count = 0 then
		LogMessage "     &lt;layer driving no ports&gt;"
	else
		LogMessage "     Layer drives:"
		for i = 0 to count - 1
			LogMessage "       " &amp; oPorts(i).Target.FullName
		next				
	end if
end sub
' This example should log something like:
'INFO : CONTAINER: Material
'INFO :    Layer 1: SharedLayer
'INFO :      Color driven by: Fractal
'INFO :      Layer drives:
'INFO :        sphere.Material.Phong.diffuse
'INFO :        sphere.Material.Color2scalar.input
'INFO :    Layer 2: Rough
'INFO :      Color: (0.7,0.7,0.7)
'INFO :      &lt;layer driving no ports&gt;</pre></td></tr>
</table>
</div></p></div>

<h3>See Also</h3>
<div><p><a href="#!/url=./si_cmds/AddTextureLayer.html">AddTextureLayer</a> <a href="#!/url=./si_om/Shader.CreateTextureLayer.html">Shader.CreateTextureLayer</a> <a href="#!/url=./si_om/Material.CreateTextureLayer.html">Material.CreateTextureLayer</a> <a href="#!/url=./si_om/Material.AddSharedTextureLayer.html">Material.AddSharedTextureLayer</a></p></div>

      <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br /></div>
   </div></body>
</html>
