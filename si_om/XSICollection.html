<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
<link href="../style/prettify.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../scripts/prettify.js"></script><script src="../scripts/lib/jquery-1.9.1.min.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script>
      <title>XSICollection</title>
   
</head>
   <body height="100%"><div class="body_content" id="body-content"><style>
/*  These settings override ones in the default stylesheets
	used by the merged files that cause problems in combination
	with the standard HTML help styles and page templates. */

div, div.example, div.tip {
	 margin:0;
}

td.example {
	background: inherit;
}

/* This fixes a problem with nested pre blocks on an example page */
pre pre {
	display:block;
	padding:0;
	border-style:none;
}
</style><link rel="stylesheet" href="si_om/css/en.css" type="text/css" /><script>$(document).ready(function() { yepnope.injectJs("./si_om/lib/utils.js"); });</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">var reflinkid = "si_cpp"; var reflinkdata = new Array(); function closeRefLinkDiv() { }; $(document).on('click', function() { closeRefLinkDiv(); } );</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/multireflink.js"); });</script><script>$(document).ready(function () { prettyPrint(); } );</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type='text/javascript'>$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script type="text/javascript">
 </script><!-- begin MT -->
            
            <div id='MicrosoftTranslatorWidget' class='Dark' style='position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden'></div><div id="reflinkdiv" style="display:none; font-family: 'RobotoRegular', Arial, Tahoma, sans-serif; visibility:hidden; position:absolute; z-index:40001; padding:5px; border-style:solid; border-width:1px; border-color:#666666; background-color:#dfdfdf; overflow:visible"></div>
      <div>
         <div class="head">
            <h1>XSICollection</h1>
         </div>

<h2 class="pagehead">XSICollection</h2>

<p><a href="#!/url=./si_om/_hier.html#oh_XSICollection">Object Hierarchy</a></p>

<h3>Introduced</h3>
<div><p>v1.0</p></div>

<h3>Description</h3>
<div><p> A Collection is an object that stores a "list" or "grouping" of multiple objects.  The XSICollection 
is normally used to create, and subsequently process, a temporary list of objects from within the scene. 
A typical use of XSICollection is demonstrated in one of the examples for the <a href="#!/url=./si_om/Shader.html">Shader</a> object.<br /><br />
Instances of the XSICollection are not persisted and, unlike the <a href="#!/url=./si_om/Group.html">Group</a> object, are not 
part of the <a href="#!/url=./si_om/Scene.html">Scene</a>. One way to persist the contents of an XSICollection is to store the 
return value of <a href="#!/url=./si_om/XSICollection.GetAsText.html">XSICollection.GetAsText</a> inside a <a href="#!/url=./files/String.htm">String</a><a href="#!/url=./si_om/Parameter.html">Parameter</a> 
in a <a href="#!/url=./si_om/CustomProperty.html">CustomProperty</a>. <br /><br />
The Object Model also contains many other collection objects, for example, the <a href="#!/url=./si_om/PropertyCollection.html">PropertyCollection</a>
and the <a href="#!/url=./si_om/ParameterCollection.html">ParameterCollection</a>.  Enumerating through all these objects is identical (using the Item 
and Count properties).  However these other collections only contain objects of one single type and the script writer 
cannot add or remove objects in these collections.  For this reason XSICollection is the most suitable choice for 
most scripts. <br /><br />
Each script language also provides its own <a href="#!/url=./files/Array.htm">Array</a> support which can be similar to the XSICollection 
object. This "native" collection support can be useful inside the implementation of a script but cannot be easily 
understood by C++ or other scripting languages.  For example, custom <a href="#!/url=./si_om/Command.html">Command</a>s cannot receive JScript 
arrays as arguments. These collection objects also do not have the same convenient capability that the XSICollection 
has for converting between the string representation of an object and the Object Model representation (see
<a href="#!/url=./si_om/XSICollection.SetAsText.html">XSICollection.SetAsText</a>). <br /><br />
The equivalent object in the C++ API is the CRefArray.
</p></div>

<h3>Methods</h3>
<div><p><table>
	<tr>

		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Add.html">Add</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.AddItems.html">AddItems</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Expand.html">Expand</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Filter.html">Filter</a>		</td>	</tr>

	<tr>

		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.FindObjectsByMarkingAndCapabilities.html">FindObjectsByMarkingAndCapabilities</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.GetAsText.html">GetAsText</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Remove.html">Remove</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.RemoveAll.html">RemoveAll</a>		</td>	</tr>

	<tr>

		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.RemoveItems.html">RemoveItems</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.SetAsText.html">SetAsText</a>		</td>		<td class="members">&nbsp;		</td>		<td class="members">&nbsp;		</td>	</tr>

	<tr>

		<td class="members">&nbsp;		</td>		<td class="members">&nbsp;		</td>		<td class="members">&nbsp;		</td>		<td class="members">&nbsp;		</td>	</tr>

</table>
</p></div>

<h3>Properties</h3>
<div><p><table>
	<tr>

		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Count.html">Count</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Item.html">Item</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Type.html">Type</a>		</td>		<td class="members" style="background:#ffffc0;"><a href="#!/url=./si_om/XSICollection.Unique.html">Unique</a>		</td>	</tr>

</table>
</p></div>

<h3>Examples</h3>
<div><p><h4>1. VBScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="vbscript">Dim oColl			' object pointer for collection
Dim oItem			' for enumerating the collection
Dim iCounter		' for looping through the collection
' Create the collection as an ActiveX object
Set oColl = CreateObject("XSI.Collection")
' Add some items to it 
oColl.Add "Camera"
oColl.Add "Light"
' You can enumerate the collection...
For Each oItem In oColl
	Application.LogMessage oItem
Next
' ... or loop through it...
For iCounter = 0 To oColl.Count - 1
	Application.LogMessage oColl(iCounter)
Next
' ... or convert it to a string expression
Application.LogMessage oColl.GetAsText
' You can also find out if the collection is unique
Application.LogMessage "Is the collection unique? -- " &amp; oColl.Unique
'--------------------------------------------------
' Output of above script:
'INFO : "Camera"
'INFO : "light"
'INFO : "Camera"
'INFO : "light"
'INFO : "Camera,light"
'INFO : "Is the collection unique? -- False"</pre></td></tr>
</table>
</div><h4>2. JScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="jscript">// Create the collection as an ActiveX object
var oColl = new ActiveXObject("XSI.Collection") ;
// Add the default camera by name
oColl.Add( "Camera" ) ;
// Add an item by its Object Model reference
var oNull = ActiveSceneRoot.AddNull() ;
oColl.Add( oNull ) ;
// You can enumerate the collection...
var eCollItems = new Enumerator( oColl );
eCollItems.moveFirst();
for (; !eCollItems.atEnd(); eCollItems.moveNext() )
{
	var oItem = eCollItems.item();
	Application.LogMessage( oItem ) ;
}
// ... or loop through it...
for (var iCounter = 0 ; iCounter &lt; oColl.Count ; iCounter++ )
{
	Application.LogMessage( oColl(iCounter) ) ;
}
// ... or convert it to a string expression
Application.LogMessage( oColl.GetAsText() ) ;
// By default collections are not set to Unique
Application.LogMessage( "Is the collection unique? -- " + oColl.Unique ) ;
//--------------------------------------------------
// Output of above script:
//INFO : Camera
//INFO : null
//INFO : Camera
//INFO : null
//INFO : Camera,null
//INFO : Is the collection unique? -- false</pre></td></tr>
</table>
</div><h4>3. VBScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="vbscript">'===========================================================
' This example demonstrates how to create an XSICollection,
' how to work with collection items, and how to set the 
' get its family information 
' Create the collection and the main object to go in it
Set oXSIColl = CreateObject( "XSI.Collection" )
Set oStuff = CreatePrim( "Torus", "MeshSurface" )
' Add the object to the new collection and print out
' the family info
getMembers oStuff
' Apply an operator to make the Families seach more 
' interesting on the construction history 
ApplyOp "Twist"
' Add each operator to the collection, etc.
Set oThingey = oStuff.ActivePrimitive.ConstructionHistory
For Each s in oThingey
	getMembers s
Next
' Finally, what is in the XSICollection?
LogMessage "This collection contains these members:"
For Each c in oXSIColl
	LogMessage vbTab &amp; c &amp; " (" &amp; typename( c ) &amp; ")"
Next
'========================================================
function getMembers( in_object )
	' Make an empty collection item and assign an 
	' object to it.
	Set oCache = CreateObject( "XSI.CollectionItem" )
	oCache.Value = in_object
	' Print out the family information on the new item
	aMembership = oCache.Families
	LogMessage in_object &amp; " is a member of these families: " 
	LogMessage vbTab &amp; aMembership &amp; vbLf
	' Assign the new collection item to the collection
	oXSIColl.Add oCache
end function
'========================================================
'OUTPUT:
'INFO : "torus is a member of these families: "
'INFO : "	3D Objects
'"
'INFO : "torus.polymsh.twistop is a member of these families: "
'INFO : "	Operators,DeformOperators
'"
'INFO : "torus.polymsh.geom is a member of these families: "
'INFO : "	Operators,Converters
'"
'INFO : "This collection contains these members:"
'INFO : "	torus (X3DObject)"
'INFO : "	torus.polymsh.twistop (Operator)"
'INFO : "	torus.polymsh.geom (Operator)"</pre></td></tr>
</table>
</div></p></div>

<h3>See Also</h3>
<div><p><a href="#!/url=./si_om/CollectionItem.html">CollectionItem</a> <a href="#!/url=./si_om/siBranchFlag.html">siBranchFlag</a> <a href="#!/url=./si_om/ArgumentHandler.html">ArgumentHandler</a> <a href="#!/url=./si_om/Shader.html">Shader</a> <a href="#!/url=./si_om/Group.AddMember.html">Group.AddMember</a> <a href="#!/url=./files/Array.htm">Array</a></p></div>

      <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br /></div>
   </div></body>
</html>
