<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
<link href="../style/prettify.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../scripts/prettify.js"></script><script src="../scripts/lib/jquery-1.9.1.min.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script>
      <title>PPGLayout.Logic</title>
   
</head>
   <body height="100%"><div class="body_content" id="body-content"><style>
/*  These settings override ones in the default stylesheets
	used by the merged files that cause problems in combination
	with the standard HTML help styles and page templates. */

div, div.example, div.tip {
	 margin:0;
}

td.example {
	background: inherit;
}

/* This fixes a problem with nested pre blocks on an example page */
pre pre {
	display:block;
	padding:0;
	border-style:none;
}
</style><link rel="stylesheet" href="si_om/css/en.css" type="text/css" /><script>$(document).ready(function() { yepnope.injectJs("./si_om/lib/utils.js"); });</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">var reflinkid = "si_cpp"; var reflinkdata = new Array(); function closeRefLinkDiv() { }; $(document).on('click', function() { closeRefLinkDiv(); } );</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/multireflink.js"); });</script><script>$(document).ready(function () { prettyPrint(); } );</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type='text/javascript'>$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script type="text/javascript">
 </script><!-- begin MT -->
            
            <div id='MicrosoftTranslatorWidget' class='Dark' style='position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden'></div><div id="reflinkdiv" style="display:none; font-family: 'RobotoRegular', Arial, Tahoma, sans-serif; visibility:hidden; position:absolute; z-index:40001; padding:5px; border-style:solid; border-width:1px; border-color:#666666; background-color:#dfdfdf; overflow:visible"></div>
      <div>
         <div class="head">
            <h1>PPGLayout.Logic</h1>
         </div>

<h2 class="pagehead"><a href="#!/url=./si_om/PPGLayout.html">PPGLayout</a>.Logic <img src="images/operator.gif" alt="operator" /></h2>

<h3>Introduced</h3>
<div><p>v4.0</p></div>

<h3>Description</h3>
<div><p> Returns or sets a <a href="#!/url=./files/String.htm">String</a> value containing the script code associated with 
the layout in an <a href="#!/url=./files/cus_ppg_Creating.htm">on-the-fly</a>
custom property. This script code contains subroutines to react to events in the property page, which 
corresponds to the text found in the BeginScript/EndScript section (or equivalent 
<a href="#!/url=./files/cus_ppg_DynamicallyChangingCustomProperties.htm">Logic</a> section) of a SPDL file.
<br /><br />
The provided string must be a correctly-formed script, written in the language specified 
in the <a href="#!/url=./si_om/PPGLayout.Language.html">PPGLayout.Language</a> section.  The script is not tested for syntax 
errors at the time this call is made.
<br /><br />
The logic script consists of subroutines implemented in any of the supported Scripting 
Languages. A routine named "OnInit", if defined, is called when the PPG first loads.  To 
react to a parameter changing, create a routine named "PARAMSCRIPTNAME_OnChanged" with a
<a href="#!/url=./files/cus_self_Prefixes.htm">prefix</a> (optional 
for on-the-fly custom properties; defaults to the property name for plug-ins).  To provide 
script code that gets executed when a button is pressed, create "BUTTONNAME_OnClicked" (same
<a href="#!/url=./files/cus_self_Prefixes.htm">prefixing</a> rules 
apply).  In all these routines a global instance of the object <a href="#!/url=./si_om/PPG.html">PPG</a> is 
available to get context information.
<br /><br />
Note: To avoid conflicts with other routines in an on-the-fly custom property, you can 
specify a prefix using the <a href="#!/url=./si_om/siPPGLayoutAttribute.html#siUILogicPrefix">siUILogicPrefix</a> attribute. 
This differs from the way that these event handlers are specified for plug-in based custom 
properties, which by default use the property name as a prefix. For more information on the
differences between naming plug-in based and on-the-fly event handlers, see 
<a href="#!/url=./files/cus_self_Prefixes.htm">Using Prefixes with Custom Properties</a>
and <a href="#!/url=./files/cus_self_NamingPluginItems.htm">Naming Plug-in Items</a>.
<br /><br />
This property makes it possible to still have property page event handling on a custom object even 
when there is no associated SPDL file.  For example it would be possible to read a script file into 
a string and provide it as the value of this property.
<br /><br />
Rather than using this property to embed script code directly in the PPGLayout, it is also possible
to specify an external file, using the <a href="#!/url=./si_om/siPPGLayoutAttribute.html#siUILogicFile">siUILogicFile</a> attribute.  
See <a href="#!/url=./si_om/PPGLayout.SetAttribute.html">PPGLayout.SetAttribute</a>.
<br /><br />
It is not necessary to set this Property for a <a href="#!/url=./si_om/CustomProperty.html">CustomProperty</a> that is based on a 
<a href="#!/url=./si_om/PluginItem.html">PluginItem</a>.  In that case it is possible to write the event handling callbacks
directly in the same script file that implements the <a href="#!/url=./si_om/Plugin.html">Plugin</a> (see 
<a href="#!/url=./si_om/PluginRegistrar.RegisterProperty.html">PluginRegistrar.RegisterProperty</a>).
</p></div>

<h3>C# Syntax</h3>
<div><p><table>
	<tr>
		<td class="example"><pre>// get accessor
String rtn = PPGLayout.Logic;
// set accessor
PPGLayout.Logic = String;</pre>		</td>	</tr>
</table>
</p></div>

<h3>Examples</h3>
<div><p><h4>JScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="jscript">/*
	This script demonstrates how it is possible to create a modal dialog box from 
	scripting to ask a user a question.  It then generates a simple skeleton based 
	on the number of bones and positions requested by the user.
	Key points of this example:
	(1) Advantage of Object Model API over SPDL files.  
	Because "for" loops can be used to dynamically add as many parameters 
	are necessary it is easy to handle a variable number of options.  For
	instance, this example can be changed to support 10 bone skeletons 
	instead of 5 bone skeletons by changing a single variable.
	(2) Single script file takes care the entire plug-in
	(3) Logic code can be added to dynamically change the layout in response
	to the user's actions.  This replaced the need for "spdl logic".
	(4) JScript's ability to get the source code associated with a function
	using the toString() property.
*/
g_maxbones = 5 ;
Main() ;
function Main()
{	
	var oPSet = CreatePSet() ;
	// We're going to take some of the routines in the script and 
	// inject the code into the PPG layout, using the convenient
	// toString() method of JScript
	// Alternatively we could have saved that code as a separate 
	// file
	var oLayout = oPSet.PPGLayout
	oLayout.Logic = OnInit.toString() +
	                BoneNumber_OnChanged.toString() + 
	                CreateLayout.toString() + 
	                AddXYZRow.toString() ;
	oLayout.Language = "JScript" ;
	if ( !InspectObj( oPSet, null, null, siModal, false ) ) {
		CreateBones( oPSet ) ;
	}
	// Erase the temporary pset
	DeleteObj( oPSet ) ;
}
function CreatePSet()
{
	var oPSet = ActiveSceneRoot.AddProperty( "CustomProperty", false, "Create_Bones_SDK_Example" ) ;
	// Default number of bones is three
	oPSet.AddParameter3( "BoneNumber", siInt4, 3 ) ;
	oPSet.AddParameter3( "origin_x", siDouble, 0 ) ;
	oPSet.AddParameter3( "origin_y", siDouble, 0 ) ;
	oPSet.AddParameter3( "origin_z", siDouble, 0 ) ;
	// Start bone numbering at "1" instead of 0 for usability
	for ( i = 1 ; i &lt;= g_maxbones ; i++ ) {
		// We use a simple naming scheme.  
		// e.g. "b4_x" is the "x" axis of bone 4.	
		oPSet.AddParameter3( "b" + i.toString() + "_x", siDouble, i ) ;
		oPSet.AddParameter3( "b" + i.toString() + "_y", siDouble, i ) ;
		oPSet.AddParameter3( "b" + i.toString() + "_z", siDouble, i ) ;
	}
	// None of the parameters are animatable - we are only using them
	// temporarily for the UI
	for ( i = 0 ; i &lt; oPSet.Parameters.Count ; i++ ) {
		oPSet.Parameters(i).Animatable = false ;
	}
	return oPSet ;
}
// Do the work based on the values the user has entered in the 
// Custom Property
function CreateBones( oPSet )
{
	// There must always be at least 1 bone
	oChainRoot = ActiveSceneRoot.Add3DChain( 
		new Array( oPSet.origin_x.Value, oPSet.origin_y.Value, oPSet.origin_z.Value ),
		new Array( oPSet.b1_x.Value, oPSet.b1_y.Value, oPSet.b1_z.Value ) 
	) ;
	//  Create a variable number of additional bones
	for ( i = 2 ; i &lt;= oPSet.BoneNumber.Value ; i++ )
	{	
		strBoneName = "b" + i.toString() ;	
		oChainRoot.AddBone( Array( oPSet.Parameters( strBoneName + "_x" ).Value,
	                               oPSet.Parameters( strBoneName + "_y" ).Value,
	                               oPSet.Parameters( strBoneName + "_z" ).Value ) ) ;
	}
}
// Event logic section - this code gets injected as part of the layout
// Hence it can't rely on any global variables or other functions.
function OnInit()
{	
	// Create the initial layout, based on the
	// default number of bones
	BoneNumber_OnChanged()
}
function BoneNumber_OnChanged()
{
	// Redraw the UI, showing only controls
	// relevant to the number of Bones selected in the drop down
	CreateLayout(PPG.BoneNumber.Value );	
	PPG.Refresh() ;
}
function CreateLayout( in_cntBones )
{
	var oLayout = PPG.PPGLayout ;
	oLayout.Clear() ; // Flush old layout
	var oItem = oLayout.AddEnumControl( 
	                    "BoneNumber", 
	                    Array( "One", 1, 
	                           "Two", 2, 
	                           "Three", 3, 
	                           "Four", 4, 
	                           "Five", 5 ),
	                    siControlCombo )
	oItem.Label = "Number of Bones" ;
	oLayout.AddGroup( "Bone Positions" );
		AddXYZRow( oLayout, "Origin", "origin_x", "origin_y", "origin_z" ) ;
		for ( i = 1 ; i &lt;= in_cntBones ; i++ ) {
			strOfI = i.toString() ;
			AddXYZRow( 
			    oLayout, 
			    "Bone " + strOfI, 
			    "b" + strOfI + "_x", 
			    "b" + strOfI + "_y", 
			    "b" + strOfI + "_z" ) ;
		}
	oLayout.EndGroup() ;
}
// Add a XYZ vector of parameters to the layout
function AddXYZRow( in_Layout, in_Label, in_xName, in_yName, in_zName )
{
	in_Layout.AddGroup( in_Label ) ;
		in_Layout.AddRow();	
			oItem = in_Layout.AddItem( in_xName ) ;
			oItem.SetAttribute( siUIValueOnly, true ) ;
			oItem.SetAttribute( siUINoSlider, true ) ;
			oItem = in_Layout.AddItem( in_yName ) ;
			oItem.SetAttribute( siUIValueOnly, true ) ;	
			oItem.SetAttribute( siUINoSlider, true ) ;
			oItem = in_Layout.AddItem( in_zName ) ;
			oItem.SetAttribute( siUIValueOnly, true ) ;
			oItem.SetAttribute( siUINoSlider, true ) ;
		in_Layout.EndRow() ;		
	in_Layout.EndGroup() ;
}</pre></td></tr>
</table>
</div></p></div>

<h3>See Also</h3>
<div><p><a href="#!/url=./si_om/PPGLayout.Language.html">PPGLayout.Language</a></p></div>

      <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br /></div>
   </div></body>
</html>
