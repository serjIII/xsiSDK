<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
<link href="../style/prettify.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../scripts/prettify.js"></script><script src="../scripts/lib/jquery-1.9.1.min.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script>
      <title>CaptureViewport</title>
   
</head>
   <body height="100%"><div class="body_content" id="body-content"><style>
/*  These settings override ones in the default stylesheets
	used by the merged files that cause problems in combination
	with the standard HTML help styles and page templates. */

div, div.example, div.tip {
	 margin:0;
}

td.example {
	background: inherit;
}

/* This fixes a problem with nested pre blocks on an example page */
pre pre {
	display:block;
	padding:0;
	border-style:none;
}
</style><link rel="stylesheet" href="si_cmds/css/en.css" type="text/css" /><script>$(document).ready(function() { yepnope.injectJs("./si_cmds/lib/utils.js"); });</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">var reflinkid = "si_cpp"; var reflinkdata = new Array(); function closeRefLinkDiv() { }; $(document).on('click', function() { closeRefLinkDiv(); } );</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/multireflink.js"); });</script><script>$(document).ready(function () { prettyPrint(); } );</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type='text/javascript'>$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script type="text/javascript">
 </script><!-- begin MT -->
            
            <div id='MicrosoftTranslatorWidget' class='Dark' style='position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden'></div><div id="reflinkdiv" style="display:none; font-family: 'RobotoRegular', Arial, Tahoma, sans-serif; visibility:hidden; position:absolute; z-index:40001; padding:5px; border-style:solid; border-width:1px; border-color:#666666; background-color:#dfdfdf; overflow:visible"></div>
      <div>
         <div class="head">
            <h1>CaptureViewport</h1>
         </div>

<h2 class="pagehead">CaptureViewport</h2>

<h3>Introduced</h3>
<div><p>v1.0</p></div>

<h3>Description</h3>
<div><p>
Captures the viewport into an image sequence.
<br /><br />
Note: This command does not work in normal batch mode because it relies on the Softimage user interface.  However
you can use the "-uiscript" command line argument instead of "-script" to use this command as part of a batch process.
</p></div>

<h3>Scripting Syntax</h3>
<div><p><table>
	<tr>
		<td class="example"><pre>CaptureViewport( [Target], [Interactive] );</pre>		</td>	</tr>
</table>
</p></div>

<h3>Parameters</h3>
<div><p><table cellpadding="5" cellspacing="5">
	<tr>
		<th title="Name of the parameter">Parameter		</th>
		<th title="Data type">Type		</th>
		<th title="Description of the parameter">Description		</th>
	</tr>
	<tr>
		<td class="name">Target		</td>
		<td><a href="#!/url=./files/Long.htm">Long</a>		</td>
		<td>
Viewport to capture.			<p class="cell"><span class="hilite">Default Value: </span>
-1 (the current viewport, or viewport B if no current viewport)			</p>
			<table cellpadding="5" cellspacing="5">
				<tr>
					<td>						<p class="cell"><span class="hilite">Possible Values: </span>						</p>					</td>
					<td>						<p class="cell"><span class="hilite">Description: </span>						</p>					</td>
				</tr>
				<tr>
					<td class="name">-1					</td>
					<td>The current viewport (under the cursor)					</td>
				</tr>
				<tr>
					<td class="name">1					</td>
					<td>Viewport A					</td>
				</tr>
				<tr>
					<td class="name">2					</td>
					<td>Viewport B					</td>
				</tr>
				<tr>
					<td class="name">3					</td>
					<td>Viewport C					</td>
				</tr>
				<tr>
					<td class="name">4					</td>
					<td>Viewport D					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="name">Interactive		</td>
		<td><a href="#!/url=./files/Boolean.htm">Boolean</a>		</td>
		<td>
Specifies whether running in batch mode (False) or interactive mode (True)			<p class="cell"><span class="hilite">Default Value: </span>
False			</p>
		</td>
	</tr>
</table>
</p></div>

<h3>Examples</h3>
<div><p><h4>1. JScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="jscript">/*
	This example demonstrates how to perform a viewport capture via scripting.
	The File Format is specified by the File Name extension. To specify the codec parameters, 
	you can save a preset via the UI and then load the preset back by scripting anytime you need it.
	You can also specify the codec parameters by setting the "DSCodec" parameter, which
	contains an encoded string for the codec parameters. The string for a desired set of codec
	parameters can be obtained by doing a capture interactively as following:
	- in a 3D view, click the Camera pulldown menu &gt; Start Capture to open the Capture Viewport dialog
	- select the desired format from the File Format pulldown menu
	- click Codec to select the desired parameters, click OK to exit the codec dialog
	- click OK to start a capture
	The encoded string for the codec parameters is printed in the Script History window. You
	can copy it for future use in scripting.
	You can also get the encoded codec parameters string by scripting, e.g.:
		LogMessage( GetValue("ViewportCapture.DSCodec"));
*/
// Get the current frame
var currFrame = ActiveProject.Properties.Item("Play Control").Parameters.Item("Current").Value;
// Set the capture options
var oViewportCapture = Dictionary.GetObject("ViewportCapture");
// Capture a 1-frame sequence 
oViewportCapture.NestedObjects.Item("Start Frame").Value = currFrame;
oViewportCapture.NestedObjects.Item("End Frame").Value = currFrame;         
// Specify the output file name
// The output file format is determined by the extension
oViewportCapture.NestedObjects.Item("File Name").Value = "C:\\test.mov";
// Set the Quicktime codec parameters (in this case: "Keyframe every 10 frames")
SetValue("ViewportCapture.DSCodec", "AAAAFnNwdGxycHphAAAAAAAQAAACAAAAABR0cHJsAAACAAAd+FEAAAAKAAAAGGRyYXQAAAAAAAAAUwAAAQAAAAEAAAAACW1wc28AAAAADG1mcmEAAAAAAAAADHBzZnIAAAAAAAAACWJmcmEAAAAACm1wZXMAAAAAABxoYXJkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKc2RuZQAAAAAADGNtZnJhcHBsAAAAAA==", null);
// Do not display dialog
CaptureViewport( 2, false );</pre></td></tr>
</table>
</div><h4>2. VBScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="vbscript">CreatePrim "Sphere", "NurbsSurface", "MySphere"
SetValue "PlayControl.Out", 40
' Setting a key frame on XPos at frame 1
SaveKey "MySphere.kine.local.posx", 1, -9.0
' Setting a key frame on XPos at frame 10
SaveKey "MySphere.kine.local.posx", 10, 3.0
' Setting a key frame on XPos at frame 30
SaveKey "MySphere.kine.local.posx", 30,-3.0
' Setting a key frame on XPos at frame 40
SaveKey "MySphere.kine.local.posx", 40, 9.0
' Setting a key frame on YPos at frame 1
SaveKey "MySphere.kine.local.posy", 1, -2.0
' Setting a key frame on YPos at frame 30
SaveKey "MySphere.kine.local.posy", 30, 2.0
SetDisplayMode "Camera", "shaded"
CaptureViewport 2, true</pre></td></tr>
</table>
</div></p></div>

<h3>See Also</h3>
<div><p><a href="#!/url=./si_cmds/Flipbook.html">Flipbook</a> <a href="http://softimage.wiki.softimage.com/sdkdocs/xsiparams/ViewportCapture.html">Viewport Capture parameters</a></p></div>

      <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br /></div>
   </div></body>
</html>
