/*
	=======================================================================================

		This keyhandler enables the user to press a key inside the TOC window and
		move directly to the toc entries that begin with the pressed letter. These
		functions are only called by the HTML TOC files that are generated by the
		XHTML.xsl stylesheet (from the topiclists in the sorted_*.xml files):
		
		  -	The init() function is called by the onLoad event (body tag for
		  	the _az.html, _azobj.html, etc. files) and just tells the browser to
		  	capture all keypress events.
		
		  -	The keyhandler() function (ie., called by the onKeyPress event) is the 
			handler for the KEYPRESS event. It has been written to work with either 
			Netscape or IExplorer.

	=======================================================================================
*/
function init() {
	if ( navigator.appName == "Netscape" ) { document.captureEvents(Event.KEYPRESS); } // needed if you wish to cancel the key
	document.onkeypress = keyhandler;
}

function keyhandler(e) {
	var keycode = ( navigator.appName == "Netscape" )  ? e.which : event.keyCode;
	var letter = String.fromCharCode(keycode);
	letter = letter.toUpperCase();

	if ( letter >= 'A' && letter <= 'Z'  ) { location.href = '#' + letter; }

	/* DEBUG
	if (keycode != 0) { alert("Key pressed! ASCII-value: " + keycode); }
	*/
}
