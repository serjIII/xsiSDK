<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
<link href="../style/prettify.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../scripts/prettify.js"></script><script src="../scripts/lib/jquery-1.9.1.min.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script>
      <title>GetValue</title>
   
</head>
   <body height="100%"><div class="body_content" id="body-content"><style>
/*  These settings override ones in the default stylesheets
	used by the merged files that cause problems in combination
	with the standard HTML help styles and page templates. */

div, div.example, div.tip {
	 margin:0;
}

td.example {
	background: inherit;
}

/* This fixes a problem with nested pre blocks on an example page */
pre pre {
	display:block;
	padding:0;
	border-style:none;
}
</style><link rel="stylesheet" href="si_cmds/css/en.css" type="text/css" /><script>$(document).ready(function() { yepnope.injectJs("./si_cmds/lib/utils.js"); });</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">var reflinkid = "si_cpp"; var reflinkdata = new Array(); function closeRefLinkDiv() { }; $(document).on('click', function() { closeRefLinkDiv(); } );</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/multireflink.js"); });</script><script>$(document).ready(function () { prettyPrint(); } );</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type='text/javascript'>$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script type="text/javascript">
 </script><!-- begin MT -->
            
            <div id='MicrosoftTranslatorWidget' class='Dark' style='position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden'></div><div id="reflinkdiv" style="display:none; font-family: 'RobotoRegular', Arial, Tahoma, sans-serif; visibility:hidden; position:absolute; z-index:40001; padding:5px; border-style:solid; border-width:1px; border-color:#666666; background-color:#dfdfdf; overflow:visible"></div>
      <div>
         <div class="head">
            <h1>GetValue</h1>
         </div>

<h2 class="pagehead">GetValue</h2>

<h3>Introduced</h3>
<div><p>v1.0</p></div>

<h3>Description</h3>
<div><p>
Returns the value of a parameter at a specific frame. This is a very 
powerful command because it can apply to any parameter, and it can 
convert a return value to an object in some cases. It also isn't 
necessarily tied to a parameter, as in the case of using it to return
a collection of selected objects.<br /><br />
The example below demonstrates how versatile this command is. It returns
whatever value the parameter contains, no matter what type of value it is.
If the parameter or entity is attached to an object, then the object is
returned, rather than a simple data value (like a string with the name of
the object). For example, the following statement returns an 
<a href="#!/url=./si_om/XSICollection.html">XSICollection</a> of selected items:<br /><br />
Set objSel = GetValue( "SelectionList" )<br /><br />
Note: If this command returns an object (instead of a simple data value) 
and you are using VBScript, you must use the 'Set' keyword in order to 
get the object. If you omit 'Set', the string name of the object(s) is
returned instead.<br /><br />
On the other hand, if you try to assign a simple data value to an object,
this command generates an 'Object required' error message. For example, if
you tried to assign the returned posx value as an object as in this case:<br /><br />
Set dblX = GetValue( "circle.kine.local.pos.posx" )<br /><br />
You can usually test for the return value by using the TypeName() function
for VBScript (which reports back object type as well as simple data type).
For JScript, you can use the ClassName() method, which reports on the object
type or the typeof operator, which reports only on the simple data type.<br /><br />
The counterpart to this command is the <a href="#!/url=./si_cmds/SetValue.html">SetValue</a> command, 
which allows you to set parameter values. <br /><br />
The Object Model provides alternatives to GetValue and SetValue. For example, 
parameter values can be retrieved and modified using <a href="#!/url=./si_om/Parameter.Value.html">Parameter.Value</a>
as demonstrated in the second example below.  In addition, objects can be retrieved 
using <a href="#!/url=./si_om/Dictionary.GetObject.html">Dictionary.GetObject</a>.
</p></div>

<h3>Scripting Syntax</h3>
<div><p><table>
	<tr>
		<td class="example"><pre>oVariant = GetValue( Target, [Time] );</pre>		</td>	</tr>
</table>
</p></div>

<h3>Return Value</h3>
<div><p><a href="#!/url=./files/Variant.htm">Variant</a></p></div>

<h3>Parameters</h3>
<div><p><table cellpadding="5" cellspacing="5">
	<tr>
		<th title="Name of the parameter">Parameter		</th>
		<th title="Data type">Type		</th>
		<th title="Description of the parameter">Description		</th>
	</tr>
	<tr>
		<td class="name">Target		</td>
		<td><a href="#!/url=./files/String.htm">String</a>		</td>
		<td>
<a href="#!/url=./files/paramexpr.htm">Parameter</a> value to retrieve. 		</td>
	</tr>
	<tr>
		<td class="name">Time		</td>
		<td>Number		</td>
		<td>
 Frame at which to get the value. 			<p class="cell"><span class="hilite">Default Value: </span>
Current frame.			</p>
		</td>
	</tr>
</table>
</p></div>

<h3>Examples</h3>
<div><p><h4>1. VBScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="vbscript">'
'    This example just demonstrates some of the different values 
'    you can find using this command. 
'       NB: If you want to use the GetValue command to return
'           an object, you need to use the 'Set' keyword for VBScript
'
rtn = GetValue("Camera.aspect")
LogMessage TypeName(rtn)				' returns Double
rtn = GetValue("Camera.kine.posz", 25)
LogMessage TypeName(rtn)				' returns Boolean
rtn = GetValue("light.Name")
LogMessage TypeName(rtn)				' returns String
' GetValue() on an object just returns the object:
set rtn = GetValue("Layers.Layer_Default")
LogMessage TypeName(rtn)				' returns Layer
' You can also convert the selection list to the selection object
set rtn = GetValue("SelectionList")
LogMessage TypeName(rtn)				' returns Object (= collection)
LogMessage rtn.Type					' returns XSICollection
LogMessage TypeName(rtn(0))				' returns X3DObject</pre></td></tr>
</table>
</div><h4>2. JScript Example</h4><div class="example"><table>
<tr>
<td class="example"><pre class="jscript">/*
This example demonstrates how you can get and set parameter values
using one of the following:
(1) GetValue or SetValue scripting commands
(2) the Parameter object (long version)
(3) a shortcut to the Parameter object
*/
NewScene( null, false);
// First start by getting an object pointer to the sphere, which we will
// use with the object model versions
ActiveSceneRoot.AddGeometry( "sphere", "meshsurface" );
var oSphere = ActiveSceneRoot.FindChild( "Sphere" );
// (1) Change the sphere's posx value using commands:
dblX = GetValue( "sphere.kine.local.pos.posx" );
dblX = dblX - 1.25;
SetValue( "sphere.kine.local.pos.posx", dblX );
// (2) Restore the value but this time use the OM (long way)
dblX = oSphere.Kinematics.Local.Parameters( "posx" ).Value;
dblX = dblX + 1.25;
oSphere.Kinematics.Local.Parameters( "posx" ).Value = dblX;
// (3) Change the value back again with the OM shortcut
dblX = oSphere.posx.Value;
dblX = dblX + 1.25;
oSphere.posx.Value = dblX;</pre></td></tr>
</table>
</div></p></div>

<h3>See Also</h3>
<div><p><a href="#!/url=./si_cmds/SetValue.html">SetValue</a> <a href="#!/url=./si_om/Parameter.html">Parameter</a> <a href="#!/url=./si_om/Dictionary.GetObject.html">Dictionary.GetObject</a> <a href="#!/url=./si_cmds/ToggleValue.html">ToggleValue</a></p></div>

      <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br /></div>
   </div></body>
</html>
