<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head><script src="../scripts/lib/jquery-1.9.1.min.js" type="text/javascript"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script>
      <title>sicppsdk_win32.h File Reference</title>
   
</head>
   <body height="100%"><div class="body_content" id="body-content"><link rel="stylesheet" type="text/css" href="si_cpp/navtree.css"><link rel="stylesheet" type="text/css" href="si_cpp/doxygen.css"><link rel="stylesheet" type="text/css" href="si_cpp/tabs.css"><link rel="stylesheet" type="text/css" href="style/adsk.cpm.css"><script>$(document).ready(function() { yepnope.injectJs("./scripts/yepnope.1.5.4-min.js"); });</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">
var weAreIn21 = $("div#main.view-active").length;
var prefix = "";
if (weAreIn21)
{ prefix = "si_cpp/"; }
yepnope([{
load:[prefix + "jquery.js", prefix + "navtree.js", prefix + "resize.js", prefix + "dynsections.js"],
complete: function() {
  dQuery = jQuery.noConflict('true');
  dQuery(window).load(resizeHeight);
  dQuery(document).ready( function () {
    setTimeout( function () {
      initResizable();
      initNavTree('sicppsdk__win32_8h.html', prefix);
      dQuery(window).trigger("load");
      }, 100);
    }
  );
}
}]
)
</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type='text/javascript'>$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><!-- begin MT -->
            
            <div id='MicrosoftTranslatorWidget' class='Dark' style='position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden'></div>
      <div>
         <div class="head">
            <h1>sicppsdk_win32.h File Reference</h1>
         </div>

    <div id="top"><!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="#!/url=./si_cpp/index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="#!/url=./si_cpp/pages.html"><span>Topics</span></a></li>
      <li><a href="#!/url=./si_cpp/modules.html"><span>Modules</span></a></li>
      <li><a href="#!/url=./si_cpp/namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="#!/url=./si_cpp/annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="#!/url=./si_cpp/files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="#!/url=./si_cpp/files.html"><span>File&#160;List</span></a></li>
      <li><a href="#!/url=./si_cpp/globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>

<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sicppsdk_win32.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sicppsdk.h&gt;</code><br>
<code>#include &lt;<a class="el" translate="no" href="#!/url=./si_cpp/xsi__value_8h_source.html">xsi_value.h</a>&gt;</code><br>
</div><a name="details" id="details"></a><h2 class="groupheader">File Description</h2>
<div class="textblock"><p>Win32 utilities. </p>
<p>Copyright 2008 Autodesk, Inc. All rights reserved. Use of this software is subject to the terms of the Autodesk license agreement provided at the time of installation or download, or which otherwise accompanies this software in either electronic or hard copy form. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab0f7898abe648c0d0e2bd013a889f103"><td class="memItemLeft" translate="no" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" translate="no" valign="bottom"><a class="el" translate="no" href="#!/url=./si_cpp/sicppsdk__win32_8h.html#ab0f7898abe648c0d0e2bd013a889f103">XSIVariantToCValue</a> (const VARIANT *in_Variant, <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CValue.html">XSI::CValue</a> &amp;out_val)</td></tr>
<tr class="separator:ab0f7898abe648c0d0e2bd013a889f103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d5ea35baf496c1b7386e378fa73497"><td class="memItemLeft" translate="no" align="right" valign="top">HRESULT&#160;</td><td class="memItemRight" translate="no" valign="bottom"><a class="el" translate="no" href="#!/url=./si_cpp/sicppsdk__win32_8h.html#a89d5ea35baf496c1b7386e378fa73497">XSIVariantFromCValue</a> (const <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CValue.html">XSI::CValue</a> &amp;in_value, VARIANT *out_var)</td></tr>
<tr class="separator:a89d5ea35baf496c1b7386e378fa73497"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab0f7898abe648c0d0e2bd013a889f103"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname" translate="no">HRESULT XSIVariantToCValue </td>
          <td>(</td>
          <td class="paramtype">const VARIANT *&#160;</td>
          <td class="paramname"><em>in_Variant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CValue.html">XSI::CValue</a> &amp;&#160;</td>
          <td class="paramname"><em>out_val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper to convert from the Win32 VARIANT structure to a CValue. This function is useful for plug-ins which mix the COM and C++ versions of the object model in their implementation.</p>
<p>The VARIANT is the data type used internally by scripting languages and, like CValue, it can represent many different types, including strings, objects, integers, doubles and arrays. A VARIANT containing a BSTR is converted to a CValue containing a CString. A VARIANT referring to a Softimage COM object is converted to a CValue containing the equivalent <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CRef.html" title="This class is used to reference Softimage objects. Each instance of an CRef maintains a link with onl...">XSI::CRef</a> object. A VARIANT referencing a SAFEARRAY is converted to a CValue containing a <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CValueArray.html" title="The CValueArray is an uni-dimensional array of CValue. ">XSI::CValueArray</a>. Some uncommon types of VARIANT are not supported, in which case <code>E_INVALIDARG</code> is returned.</p>
<dl class="section user"><dt>Note:</dt><dd>The <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CComAPIHandler.html" title="The CComAPIHandler class implements a C++ wrapper for calling automation objects (scripting objects) ...">XSI::CComAPIHandler</a> object permits access to the COM version of the object model from C++, yet shields the caller from VARIANTs and other Win32-specific structures. Similarly, script code can call custom commands written in C++ and the arguments are automatically transformed from VARIANT to CValue without the need to call this routine explicitly.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in_Variant</td><td>Variant to convert. It is treated as const. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">out_val</td><td>CValue that is equivalent to the Variant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HRESULT: A LONG representing success (S_OK) or error (E_INVALIDARG, S_FALSE). </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CValue.html" title="The CValue object provides the convenience of a loosely typed variable inside a strictly typed langua...">XSI::CValue</a>, <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CStatus.html" title="Encapsulates status data types for error handling purpose. The class also exposes methods to query an...">XSI::CStatus</a>, <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CComAPIHandler.html" title="The CComAPIHandler class implements a C++ wrapper for calling automation objects (scripting objects) ...">XSI::CComAPIHandler</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a89d5ea35baf496c1b7386e378fa73497"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname" translate="no">HRESULT XSIVariantFromCValue </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CValue.html">XSI::CValue</a> &amp;&#160;</td>
          <td class="paramname"><em>in_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VARIANT *&#160;</td>
          <td class="paramname"><em>out_var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper to convert from CValue to the Win32 VARIANT structure. Normally this routine is not needed because <a class="el" translate="no" href="#!/url=./si_cpp/classXSI_1_1CComAPIHandler.html" title="The CComAPIHandler class implements a C++ wrapper for calling automation objects (scripting objects) ...">XSI::CComAPIHandler</a> or automatic conversions shield the C++ API user from needing to deal with VARIANTs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in_value</td><td>CValue to convert </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">out_var</td><td>Address of a VARIANT to fill in based on the CValue's contents. The caller is reponsible for freeing the VARIANT with ::VariantClear(). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HRESULT: A LONG representing success (S_OK) or error (E_INVALIDARG, S_FALSE). </dd></dl>

</div>
</div>

<p><a href="#!/url=./si_cpp/sicppsdk__win32_8h_source.html">Go to the source code of this file.</a></p>
</div><!-- contents -->
</div><!-- doc-content -->
          <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br></div>
   </div></body>
</html>
